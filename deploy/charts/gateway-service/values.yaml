replicaCount: 1

image:
  repository: harbor.g-oss.top/astraios/gateway-service
  tag: "latest"
  pullPolicy: IfNotPresent
imagePullSecrets:
  - name: harbor-credential

service:
  type: ClusterIP
  port: 8888

probes:
  liveness:
    enabled: true
    tcpSocket:
      port: 8888
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 2
    failureThreshold: 3
    successThreshold: 1
  readiness:
    enabled: true
    tcpSocket:
      port: 8888
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 2
    failureThreshold: 3
    successThreshold: 1

config:
  name: gateway
  host: 0.0.0.0
  port: 8888
  userService:
    endpoints:
      - user-service:8080
    timeout: 2000
    nonBlock: true
    middlewares:
      breaker: true
  jwtAuth:
    jwksUrl: http://auth-service:8081/.well-known/jwks.json
    issuer: astraios
    cacheSeconds: 300

ingress:
  enabled: true
  className: nginx
  annotations:
    # Strip /api prefix before forwarding to gateway-service
    # e.g., /api/v1/users -> /v1/users
    nginx.ingress.kubernetes.io/rewrite-target: /$2
  hosts:
    - host: astraios.g-oss.top
      paths:
        - path: /api(/|$)(.*)
          pathType: ImplementationSpecific
  # TLS is handled globally by ingress-nginx-custom's default-ssl-certificate.
  # Uncomment below only if you need a domain-specific certificate.
  # tls:
  #   - hosts:
  #       - astraios.g-oss.top
  #     secretName: astraios-tls

resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 500m
    memory: 256Mi
nodeSelector: {}
tolerations: []
affinity: {}
